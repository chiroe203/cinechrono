# CINEchrono TRAVEL 開発引き継ぎドキュメント

## 📋 プロジェクト概要

| 項目 | 内容 |
|------|------|
| プロジェクト名 | CINEchrono TRAVEL |
| ドメイン | cinechrono.com |
| 本番URL | https://cinechrono.com |
| Vercel URL | https://cinechrono-lemon.vercel.app |
| 目的 | 歴史的瞬間と映画・漫画・ゲームを年表で繋ぐWebアプリ |
| ターゲット | 中高生（世界史学習者） |
| ローカルパス | `/Users/hiroec/Desktop/cinechrono` |
| GitHub | https://github.com/chiroe203/cinechrono |

---

## ✅ 完了した作業

### Phase 1-4: 基盤構築（以前完了）
- ✅ Node.js・React・Tailwind CSS 環境構築
- ✅ GitHubリポジトリ作成・連携
- ✅ Firebase Authentication・Firestore連携
- ✅ Vercelデプロイ・カスタムドメイン設定

### Phase 5: 機能拡張（以前完了）
- ✅ サムネイル画像機能
- ✅ 世紀区切り線・紀元区切り線
- ✅ 紀元前（BC）対応
- ✅ Aboutページ作成
- ✅ アフィリエイトリンクシステム拡張
- ✅ イベントシステム再設計
- ✅ アフィリエイト表示オン/オフ機能

### Phase 7: 今回の作業 🆕

#### 1. 年表ソートロジックの全面修正
- ✅ `parseYear`関数の改良（3つのルールに対応）
- ✅ 時代区分と作品の「分離方式」配置を実装
- ✅ 世紀区切り線の正確な表示

#### 2. アフィリエイトUIの全面リデザイン
- ✅ カテゴリ別グループ化（グレーの箱）
- ✅ 表示順序の固定（動画→電子書籍→購入→ゲーム→その他）
- ✅ 購入系ボタンの新デザイン（白地+カラー下線）
- ✅ 電子書籍・動画配信系の色調整

---

## 🔥 Firebase 設定情報

### プロジェクト情報
```javascript
const firebaseConfig = {
  apiKey: "AIzaSyDyJ6IhfEAf6Bsf7LTQ5YByG8T-ou6cXwE",
  authDomain: "cinechrono-1c1a8.firebaseapp.com",
  projectId: "cinechrono-1c1a8",
  storageBucket: "cinechrono-1c1a8.firebasestorage.app",
  messagingSenderId: "1029924381560",
  appId: "1:1029924381560:web:5c36f1b9ac2ed2f7a09e8d"
};
```

### Firebase Console
- URL: https://console.firebase.google.com/project/cinechrono-1c1a8

### 管理者アカウント
- メールアドレス: `hi6.chi.330018@gmail.com`

### Firestoreコレクション
| コレクション | 用途 |
|-------------|------|
| `timeline` | 年表データ（作品・時代区分・イベント） |
| `settings` | グローバル設定（アフィリエイト表示等） |

---

## 🎯 年表ソートロジック（今回修正）

### parseYear関数のルール

| 入力形式 | 出力例 | 説明 |
|---------|--------|------|
| `1180` | 1180 | そのまま |
| `794-1185` | 794 | 最初の3-4桁を取得 |
| `12世紀` | 1101 | 世紀の開始年 |
| `12世紀前期` | 1116 | 開始年+15 |
| `12世紀中期` | 1151 | 開始年+50 |
| `12世紀後期` | 1186 | 開始年+85 |
| `紀元前264年` | -264 | 負の数で返す |

### 分離方式の配置

従来は時代区分グループが一塊で配置されていたが、今回の修正で**ヘッダーと作品を別々に年号順で配置**するように変更。

**例：平安時代（794-1185年）に平家物語（1180年）を登録した場合**

```
8世紀マーカー
└ 平安時代（794-1185）ヘッダー ← 794年の位置

9世紀マーカー
└ 850 アサシンクリード ヴァルハラ

12世紀マーカー
└ 1180-1185 平家物語 ← 平安時代に属しつつ正しい世紀に配置
└ 1187 キングダム・オブ・ヘブン
└ 1199 ロビン・フッド
```

---

## 🎨 アフィリエイトUI（今回リデザイン）

### 表示順序（固定）
1. 📺 視聴する（動画配信）
2. 📚 電子書籍で読む
3. 🛒 探す（購入）
4. 🎮 ゲームを入手
5. 🔗 その他

### 動画配信系ボタン
| サービス | 色 |
|---------|-----|
| Prime Video | ダークグレー（slate-700/800） |
| Netflix | 赤ベタ塗り |
| Disney+ | シアン/ティール系 |
| U-NEXT | 白地に黒文字（枠線あり） |
| Hulu | 緑系 |

### 電子書籍ボタン
| サービス | 色 |
|---------|-----|
| Kindle版 / Kindle Unlimited | オレンジ |
| 楽天Kobo / 楽天Books | 赤 |
| Renta! | ライトグリーン |

### 購入系ボタン（新デザイン）
白地に黒文字「○○で探す」+ カラー下線

| サービス | 下線色 |
|---------|--------|
| Amazon | オレンジ（amber-400） |
| 楽天市場 | 赤（red-600） |
| Yahoo!ショッピング | 青（blue-500） |

### グループ化
各カテゴリは薄いグレーの箱（`bg-gray-50`）でまとめ、ラベル付きで表示。

---

## 📂 現在のファイル構成

```
cinechrono/
├── public/
│   ├── index.html
│   └── favicon.ico
├── src/
│   ├── App.js              # メインコード（最新版）
│   ├── firebase.js         # Firebase設定ファイル
│   ├── index.js
│   └── index.css           # Tailwind CSS
├── node_modules/
├── package.json
├── tailwind.config.js
└── .gitignore
```

---

## 🔄 更新フロー

### コード更新時
```bash
# 1. ファイルを編集
# 2. ローカルで確認
cd /Users/hiroec/Desktop/cinechrono
npm start

# 3. Gitにコミット・プッシュ
git add .
git commit -m "機能追加: ○○"
git push

# 4. Vercelが自動デプロイ（1-2分）
```

### 大きなファイルのプッシュ時
```bash
git config http.postBuffer 524288000
git push
```

---

## 🚀 次のステップ

### 直近のタスク
- ⏳ Google Analytics 4 導入
- ⏳ プライバシーポリシーページ作成

### コンテンツ充実
- 目標: 各時代 5-10作品
- 合計: 50-100作品
- サムネイル画像も追加推奨

### 今後の機能追加案
- 検索機能
- お気に入り機能
- A/Bテスト分析（アフィリエイト有無での比較）

---

## 🛠️ トラブルシューティング

### よくあるエラー

**1. `npm start` でエラー**
```bash
rm -rf node_modules package-lock.json
npm install
npm start
```

**2. Gitプッシュでエラー（HTTP 400）**
```bash
git config http.postBuffer 524288000
git push
```

**3. 年表の順番がおかしい**
- `parseYear`関数のルールを確認
- 年号の入力形式が正しいか確認（「794-1185」「12世紀」など）

**4. 不要なデータが残っている**
- Firebase Console → timeline コレクションで直接削除

---

## 📞 次のチャットで伝えること

「CINEchrono TRAVELの開発を続けたい。引き継ぎドキュメントがある。年表ソート修正・アフィリエイトUI改善完了済み。次は○○をしたい。」

と伝えれば、Claudeがスムーズに対応します！

---

## 📝 重要なメモ

| 項目 | 内容 |
|------|------|
| ローカルパス | `/Users/hiroec/Desktop/cinechrono` |
| GitHub | https://github.com/chiroe203/cinechrono |
| Firebase Project ID | `cinechrono-1c1a8` |
| 管理者メール | hi6.chi.330018@gmail.com |
| Firebase Console | https://console.firebase.google.com/project/cinechrono-1c1a8 |
| Vercel URL | https://cinechrono-lemon.vercel.app |
| 本番ドメイン | https://cinechrono.com |
| ドメイン管理 | さくらインターネット |

---

## 🎊 現在の進捗: 97%

- ✅ プロジェクト作成
- ✅ コード実装
- ✅ GitHub 連携
- ✅ Firebase データベース連携
- ✅ Vercel デプロイ
- ✅ ドメイン接続
- ✅ アフィリエイトリンクシステム拡張
- ✅ イベントシステム再設計
- ✅ アフィリエイト表示設定機能
- ✅ 年表ソートロジック修正 🆕
- ✅ アフィリエイトUI改善 🆕
- ⏳ Google Analytics 導入
- ⏳ コンテンツ充実

---

## 📅 更新履歴

| 日時 | 内容 |
|------|------|
| 2024/12/18 | プロジェクト作成、GitHub連携完了 |
| 2024/12/18 23:30 | Firebase Authentication・Firestore連携完了 |
| 2024/12/19 10:30 | サムネイル機能・世紀区切り線追加、Vercelデプロイ完了 |
| 2024/12/19 23:45 | アフィリエイト拡張、イベント統合、表示設定機能追加 |
| 2024/12/20 01:30 | 年表ソートロジック修正、アフィリエイトUI全面リデザイン 🆕 |

---

## ✨ 完成イメージ

```
ユーザー
  ↓
cinechrono.com にアクセス
  ↓
年表を閲覧（時代区分と作品が正しい世紀順に配置）
  ↓
作品クリック → アフィリエイトリンク（グループ化されたUI）
  ↓
購入 → 収益発生

管理者（あなた）
  ↓
フッター歯車 → ログイン
  ↓
管理画面 → アフィリエイト表示をオン/オフ
  ↓
作品・時代区分・イベント追加
  ↓
Firebase に保存
  ↓
全ユーザーに即反映
```

---

頑張ってください！🚀
